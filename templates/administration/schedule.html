{% extends 'base.html' %}

{% load static %}
{% block title %}
{{ doctor.first_name }}'s Schedule
{% endblock %}
{% block content %}

<!-- Main Wrapper -->
<div class="main-wrapper">

	{% include 'administration/sidebar.html' %}

	<!-- Page Wrapper -->
	<div class="page-wrapper">
		<div class="content container-fluid">

			<!-- Page Header -->
			<div class="page-header">
				<div class="row">
					<div class="col-sm-12">
						<h3 class="page-title">My Schedules</h3>
						<ul class="breadcrumb">
							<li class="breadcrumb-item"><a href="{% url 'doctor_dashboard' %}">Dashboard</a></li>
							<li class="breadcrumb-item"><a href="javascript:(0);">Doctor</a></li>
							<li class="breadcrumb-item active">Schedule</li>
						</ul>
					</div>
				</div>
			</div>
			<!-- /Page Header -->
			<div class="container mt-4">
				<h2>Dr. {{ doctor.first_name }}'s ({{ doctor.username }}) Schedule</h2>
				<ul class="nav nav-tabs" id="scheduleTab" role="tablist">
					<li class="nav-item" role="presentation">
						<a class="nav-link active" id="create-tab" data-bs-toggle="tab" href="#create" role="tab"
							aria-controls="create" aria-selected="true">Create Slots</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" id="available-tab" data-bs-toggle="tab" href="#available" role="tab"
							aria-controls="available" aria-selected="false">Available Slots</a>
					</li>
					<li class="nav-item" role="presentation">
						<a class="nav-link" id="booked-tab" data-bs-toggle="tab" href="#booked" role="tab"
							aria-controls="booked" aria-selected="false">Booked Slots</a>
					</li>
				</ul>
				<div class="tab-content mt-3" id="scheduleTabContent">
					<!-- Make Slots Tab -->
					<div class="tab-pane fade show active" id="create" role="tabpanel" aria-labelledby="create-tab">
						<h4>Create Slots</h4>
						<form action="" method="post">
							{% csrf_token %}
							{{ form.as_p }}
							<input type="hidden" name="doc_id" value="{{ doctor.id }}">
							<input type="hidden" name="create_schedule" value="true">
							<button type="submit" class="btn btn-primary">Create {{ doctor.id }}</button>

						</form>
					</div>
					<!-- Available Slots Tab -->
					<div class="tab-pane fade " id="available" role="tabpanel"
						aria-labelledby="available-tab">
						<h4>Available Slots</h4>
						{% if available_slots %}
						<table class="table table-striped">
							<thead>
								<tr>
									<th>Date</th>
									<th>Time</th>
									<th>Duration (mins)</th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								{% for slot in available_slots %}
								<tr>
									<td>{{ slot.date }}</td>
									<td>{{ slot.start_time }}</td>
									<td>{{ slot.duration }}</td>
									<td>
										<a href="{% url 'book_slot' slot.id %}" class="btn btn-success">Book</a>
									</td>
								</tr>
								{% endfor %}
							</tbody>
						</table>
						{% else %}
						<p>No available slots at the moment.</p>
						{% endif %}
					</div>

					<!-- Booked Slots Tab -->
					<div class="tab-pane fade" id="booked" role="tabpanel" aria-labelledby="booked-tab">
						<h4>Booked Slots</h4>
						{% if booked_slots %}
						<table class="table table-striped">
							<thead>
								<tr>
									<th>Date</th>
									<th>Time</th>
									<th>Duration (mins)</th>
								</tr>
							</thead>
							<tbody>
								{% for slot in booked_slots %}
								<tr>
									<td>{{ slot.date }}</td>
									<td>{{ slot.start_time }}</td>
									<td>{{ slot.duration }}</td>
								</tr>
								{% endfor %}
							</tbody>
						</table>
						{% else %}
						<p>No slots booked yet.</p>
						{% endif %}
					</div>
				</div>
			</div>

			<!-- /Page Wrapper -->

		</div>
		<!-- /Main Wrapper -->

		{% endblock %}